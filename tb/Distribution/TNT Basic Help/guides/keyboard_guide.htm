<HTML>  
<HEAD>
  <META HTTP-EQUIV="content-type" CONTENT="text/html;charset=iso-8859-1">
  <TITLE>Introduction to Keyboard Reading</TITLE>
  <META NAME="DP" CONTENT="1.9.1/3.1.1">
  <META NAME="AppleTitle" CONTENT="Introduction to Keyboard Reading">
  <META NAME="AppleTarget" CONTENT="_right">
  <META NAME="DESCRIPTION" CONTENT="Describes all commands relating to reading keypresses from the keyboard">
</HEAD>
<BODY BGCOLOR="#ffffff" BACKGROUND="../gfx/chalk.gif">

<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" WIDTH="472"
HEIGHT="177">
  <TR VALIGN="TOP">
    <TD HEIGHT="18"><B><FONT COLOR="#330099" SIZE="+1" FACE="Helvetica,Arial">Introduction to Keyboard Reading</FONT></B></TD> 
  </TR>
  <TR>
    <TD HEIGHT="40">
      <BLOCKQUOTE>
        <FONT SIZE="-1" FACE="Geneva"><p>This guide will take you through the keyboard reading commands in TNT Basic. You will learn how to read raw keys from the keyboard input queue, and how to edit strings using the TNT Basic's inbuilt string editor.<br></blockquote><p><b><FONT COLOR="#330099" SIZE="-1" FACE="Helvetica,Arial">The Keyboard Queue</FONT></b></p></td></tr><tr><td><blockquote><FONT SIZE="-1" FACE="Geneva">Every time a key is pressed in a TNT Basic program, it is recorded and added to a queue that your program can read. The keys are recorded as <b>raw keys</b>, which are a way of storing the <i>scancode</i>, <i>character code</i> and <i>modifier keys</i> for the key press in one integer variable.</p><p>The <i>character code</i> is simply the letter or number that is painted on the key that was pressed. Different characters can be produced from the same key, depending on what <i>modifier keys</i> are being held down. The modifier keys are <b>command</b>, <b>control</b>, <b>option</b>, <b>shift</b> and <b>caps lock</b>. So if the shift key is being held down when the number "1" is typed, you will get a "!" character instead of a "1".</p><p>The <i>scancode</i> of the key is the id number of the key that was pressed, in the example above, different characters were produced from the same key, but the scancode would have been the same. The scancode of the key is constant, regardless of which modifiers were held when it was pressed.</p><p>An important difference between scancodes and character codes is that although the scancodes for every Mac keyboard in the world are the same, the characters produced when you press the keys can vary from country to country. This is due to the characters being laid out in a fashion appropriate for the native language of that country. A diagram showing all of the Mac keyboard scancodes, along with the character codes from a US/UK keyboard can be found on the <A HREF="../commands/pressed.htm">Pressed</A> command's help page.</p><p>You can read raw keys from the keyboard queue using the <A HREF="../commands/keyboardrawkey.htm">Keyboard Raw Key</A> command. This will remove one raw key from the queue and return it. The keys are returned in the order that they were typed. The keys are stored in the queue until they are asked for, even if the user lets go of the key, it will stay in the queue until it is removed. If you want to remove all keys from the keyboard queue without reading them, you can use the <A HREF="../commands/clearkeyboard.htm">Clear Keyboard</A> command.</p><p>If there are no keys in the queue, <A HREF="../commands/keyboardrawkey.htm">Keyboard Raw Key</A> will return 0. If you want to wait until there are keys in the queue again, you can use the <A HREF="../commands/waitkeypress.htm">Wait Key Press</A> command.</p><p>The following example will wait until a key is pressed, retrieve it and print out the raw key code of the pressed key.</p><p></FONT><FONT COLOR="#000000" SIZE="-2" FACE="Monaco,Arial"><FONT COLOR="#0000FF">int</FONT> pressedKey<br><FONT COLOR="#4985c6">Wait Key Press</FONT><br>pressedKey=<FONT COLOR="#4985c6">Keyboard Raw Key</FONT><br><FONT COLOR="#4985c6">print</FONT> "The raw code of the pressed key was ";pressedKey</p><p></FONT><FONT SIZE="-1" FACE="Geneva"></p><p></blockquote><p><b><FONT COLOR="#330099" SIZE="-1" FACE="Helvetica,Arial">Working with Raw Keys</FONT></b></p></td></tr><tr><td><blockquote><FONT SIZE="-1" FACE="Geneva">The raw key code isn't much good to us directly, if we want to use it we need to extract information such as the scancode, character code or modifier keys from it. To do this, we use the <A HREF="../commands/rawkeyscancode.htm">Raw Key Scancode</A>, <A HREF="../commands/rawkeychar.htm">Raw Key Char</A> and <A HREF="../commands/rawkeymodifier.htm">Raw Key Modifier</A> commands.</p><p>Here's a simple program to print out what you type until you type an "!".</p><p></FONT><FONT COLOR="#000000" SIZE="-2" FACE="Monaco,Arial"><FONT COLOR="#0000FF">int</FONT> rawKey<br><FONT COLOR="#0000FF">str</FONT> charTyped<br><FONT COLOR="#4985c6">print</FONT> "Type a ! to exit"<br><FONT COLOR="#0000FF">repeat</FONT><br>&nbsp;&nbsp;&nbsp;&nbsp;<FONT COLOR="#4985c6">Wait Key Press</FONT><br>&nbsp;&nbsp;&nbsp;&nbsp;rawKey=<FONT COLOR="#4985c6">Keyboard Raw Key</FONT><br>&nbsp;&nbsp;&nbsp;&nbsp;charTyped=<FONT COLOR="#4985c6">Raw Key Char</FONT>(rawKey)<br>&nbsp;&nbsp;&nbsp;&nbsp;<FONT COLOR="#4985c6">print</FONT> "You typed ";charTyped<br><FONT COLOR="#0000FF">until</FONT> charTyped="!"<br><FONT COLOR="#4985c6">print</FONT> "Bye!"<br></FONT><FONT SIZE="-1" FACE="Geneva"></p><p>You may notice when running this example that if you hold down a non-modifier key for any amount of time, you begin getting repeating keys from it; in the same way you would in a word processor. You can turn off key repeating using the <A HREF="../commands/keyboardrepeat.htm">Keyboard Repeat</A> command. If you want to know if a particular key is still being held you can use the <A HREF="../commands/pressed.htm">Pressed</A> command and pass it the scancode of the key you're interested in.</p><p><a name="stringeditor"></blockquote><p><b><FONT COLOR="#330099" SIZE="-1" FACE="Helvetica,Arial">The String Editor</FONT></b></p></td></tr><tr><td><blockquote><FONT SIZE="-1" FACE="Geneva">The string editor provides a means of inputting and editing strings using the keyboard. It is similar in concept to a text box in a Mac OS dialog, such as the Mac OS X login window where you can type your name. You can use the string editor to have the user enter information, such as high score entries.</p><p>The string editor has two parts, its <i>contents</i> and its <i>cursor position</i>. The contents contain the string that is currently being edited, and the cursor position states how many characters into the contents the text input cursor currently is.</p><p>The string editor doesn't get displayed on screen, instead, can read the current string using the <A HREF="../commands/stringeditorcontents.htm">String Editor Contents</A> and <A HREF="../commands/stringeditorcursor.htm">String Editor Cursor</A> commands, then draw it in whatever way is most suited for your game. To input a key into the string editor you use the <A HREF="../commands/stringeditorinput.htm">String Editor Input</A> command. You can also set the contents or cursor directly using the <A HREF="../commands/setstringeditorcontents.htm">Set String Editor Contents</A> and <A HREF="../commands/setstringeditorcursor.htm">Set String Editor Cursor</A> commands.</p><p>Here is an example that lets you enter a string then displays it. Remember that you can use the cursor keys to go back and correct mistakes. Press return when you're finished.</p><p></FONT><FONT COLOR="#000000" SIZE="-2" FACE="Monaco,Arial"><FONT COLOR="#4985c6">Graphics Mode</FONT> 640,480<br><FONT COLOR="#0000FF">int</FONT> rawKey<br><FONT COLOR="#0000FF">str</FONT> final<br><FONT COLOR="#0000FF">repeat</FONT><br>&nbsp;&nbsp;&nbsp;&nbsp;DrawStringEditor()<br>&nbsp;&nbsp;&nbsp;&nbsp;<FONT COLOR="#4985c6">Wait Key Press</FONT><br>&nbsp;&nbsp;&nbsp;&nbsp;rawKey=<FONT COLOR="#4985c6">Keyboard Raw Key</FONT><br>&nbsp;&nbsp;&nbsp;&nbsp;<FONT COLOR="#4985c6">String Editor Input</FONT> rawKey<br><FONT COLOR="#0000FF">until</FONT> <FONT COLOR="#4985c6">Raw Key Ascii</FONT>(rawKey)=13 <FONT COLOR="#FF0000">' ASCII code 13 is return</FONT></p><p><FONT COLOR="#4985c6">Set Pen Colour</FONT> <FONT COLOR="#4985c6">Black</FONT><br><FONT COLOR="#4985c6">Paint Canvas</FONT><br><FONT COLOR="#4985c6">Set Pen Colour</FONT> <FONT COLOR="#4985c6">White</FONT><br>final="You typed: " + <FONT COLOR="#4985c6">String Editor Contents</FONT><br><FONT COLOR="#4985c6">Draw Text</FONT> 320-<FONT COLOR="#4985c6">Text Width</FONT>(final)/2,240,final<br>final="Press any key to exit"<br><FONT COLOR="#4985c6">Draw Text</FONT> 320-<FONT COLOR="#4985c6">Text Width</FONT>(final)/2,280,final<br><FONT COLOR="#4985c6">Draw Frame</FONT><br><FONT COLOR="#4985c6">Wait Key Press</FONT><br><FONT COLOR="#0000FF">End</FONT></p><p><FONT COLOR="#FF0000">' Draws the current contents of the string editor to screen and puts a vertical</FONT><br><FONT COLOR="#FF0000">' bar at the current cursor position</FONT><br><FONT COLOR="#0000FF">Procedure</FONT> DrawStringEditor()<br>&nbsp;&nbsp;&nbsp;&nbsp;<FONT COLOR="#0000FF">string</FONT>  s=<FONT COLOR="#4985c6">String Editor Contents</FONT><br>&nbsp;&nbsp;&nbsp;&nbsp;<FONT COLOR="#0000FF">int</FONT>     curs=<FONT COLOR="#4985c6">String Editor Cursor</FONT><br>&nbsp;&nbsp;&nbsp;&nbsp;<FONT COLOR="#4985c6">Set Pen Colour</FONT> <FONT COLOR="#4985c6">Black</FONT><br>&nbsp;&nbsp;&nbsp;&nbsp;<FONT COLOR="#4985c6">Paint Canvas</FONT><br>&nbsp;&nbsp;&nbsp;&nbsp;<FONT COLOR="#4985c6">Set Pen Colour</FONT> <FONT COLOR="#4985c6">White</FONT><br>&nbsp;&nbsp;&nbsp;&nbsp;<FONT COLOR="#4985c6">Draw Text</FONT> 10,40,"String : "+<FONT COLOR="#4985c6">left str</FONT>(s,curs)+"|"+<FONT COLOR="#4985c6">mid str</FONT>(s,curs+1,1000000)<br>&nbsp;&nbsp;&nbsp;&nbsp;<FONT COLOR="#4985c6">Draw Frame</FONT><br><FONT COLOR="#0000FF">End Proc</FONT><br></FONT><FONT SIZE="-1" FACE="Geneva"></p></blockquote><p><b><FONT COLOR="#330099" SIZE="-1" FACE="Helvetica,Arial">Summary</FONT></b></p></td></tr><tr><td><blockquote><FONT SIZE="-1" FACE="Geneva">Every key typed into a TNT Basic program is added to a <b>key queue</b> that can be read using <A HREF="../commands/keyboardrawkey.htm">Keyboard Raw Key</A>. You can input the raw keys into the <b>String Editor</b> as a way of editing text. To tell if a particular key is currently held you can use the <A HREF="../commands/pressed.htm">Pressed</A> command which takes a key scancode. The key scancodes are the same on all keyboards, but the character they represent can change from country to country.<br></FONT>
      </BLOCKQUOTE>
    </TD>
  </TR>
  <TR VALIGN="TOP">
    <TD ALIGN="CENTER" HEIGHT="34"><FONT SIZE="-2" FACE="Geneva,Arial"><HR><A
      HREF="../io/io_frameset.htm">Table of contents</A></FONT></TD> 
  </TR>
</TABLE>

</BODY>
</HTML>
